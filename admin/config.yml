# ---------------------------- #
#   NETLIFY CMS CONFIGURATION  #
# ---------------------------- #

## This file contains the configuration settings for the Netlify CMS.

# -------------------------- #
#   Auth and Repo Settings   #
# -------------------------- #

backend:
  name: git-gateway
  branch: master


# -------------------------- #
#    Publishing Settings     #
# -------------------------- #

publish_mode: editorial_workflow


# -------------------------- #
#        Image Settings      #
# -------------------------- #

media_folder: "images/changelog"
public_folder: "/images/changelog"



# -------------------------- #
#     Collection Settings    #
# -------------------------- #

## Only the folders (collections) listed in this section
## will be accessible via the Netlify CMS. In this way
## we can limit what CMS users have the ability to access and modify.

## Docs: https://www.netlifycms.org/docs/configuration-options/#collections

# Each collection in this list has the following fields:

  # name: Used in routes, e.g., /admin/collections/blog
  # label: Used in the UI
  # folder: The path to the folder where the documents are stored
  # create: Allow users to create new documents in this collection
  # slug: Filename template, e.g., YYYY-MM-DD-title.md
  # fields: The fields for each document, usually in front matter

collections:
  # - name: "entry_types"
  #   label: "Entry Types"
  #   label_singluar: "Entry Type"
  #   create: true
  #   folder: "_data/changelog/entry-types.yml"
  #   fields:
  #     - label: "Type"
  #       name: "name"
  #       widget: "string"

  #     - label: "Display Name"
  #       name: "display_name"
  #       widget: "string"

  - name: "data"
    label: "Data"
    files:
      - name: "entry-types"
        label: "Entry Types"
        label_singluar: "Entry Type"
        file: "_data/changelog/entry-types.yml"
        fields:
          - label: "type"
            name: "type"
            widget: "list"
            fields:
              - name: "name"
                label: "Type"
                widget: "string"

              - name: "display_name"
                label: "Display Name"
                widget: "string"

  - name: "changelog" 
    label: "Changelog Entries"
    folder: "_posts"
    create: true 
    slug: "{{year}}-{{month}}-{{day}}-{{slug}}" 
    fields: 
      - label: "Title"
        name: "title"
        widget: "string"

      - label: "Publish Date"
        name: "date"
        widget: "datetime"

      - label: "Type"
        name: "entry-type"
        widget: "relation"
        collection: "data"
        file: "entry-types"
        search_fields: ["type.*.name"]
        display_fields: ["type.*.display_name"]
        value_field: "type.*.name"

      - label: "Body"
        name: "body"
        widget: "markdown"