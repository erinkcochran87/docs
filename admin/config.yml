# ---------------------------- #
#   NETLIFY CMS CONFIGURATION  #
# ---------------------------- #

## This file contains the configuration settings for the Netlify CMS.

# -------------------------- #
#   Auth and Repo Settings   #
# -------------------------- #

backend:
  name: git-gateway
  branch: master


# -------------------------- #
#    Publishing Settings     #
# -------------------------- #

publish_mode: editorial_workflow


# -------------------------- #
#        Image Settings      #
# -------------------------- #

media_folder: "images/changelog"
public_folder: "/images/changelog"



# -------------------------- #
#     Collection Settings    #
# -------------------------- #

## Only the folders (collections) listed in this section
## will be accessible via the Netlify CMS. In this way
## we can limit what CMS users have the ability to access and modify.

## Docs: https://www.netlifycms.org/docs/configuration-options/#collections

# Each collection in this list has the following fields:

  # name: Used in routes, e.g., /admin/collections/blog
  # label: Used in the UI
  # folder: The path to the folder where the documents are stored
  # create: Allow users to create new documents in this collection
  # slug: Filename template, e.g., YYYY-MM-DD-title.md
  # fields: The fields for each document, usually in front matter

collections:
  - name: "data"
    label: "Data"
    create: false
    files:
      - name: "entry_categories"
        label: "Entry Categories"
        label_singlular: "Entry Category"
        create: false
        file: "_data/changelog/categories.yml"
        fields:
          - name: "entry_categories"
            label: "Entry Categories"
            widget: list
            fields:
              - label: 'Entry Name'
                name: 'name'
                widget: 'string'

              - label: 'Entry Type'
                name: 'display_name'
                widget: 'string'

  - name: "changelog" 
    label: "Changelog Entries"
    folder: "_posts"
    create: true 
    slug: "{{year}}-{{month}}-{{day}}-{{slug}}" 
    fields: 
      - label: "Title"
        name: "title"
        widget: "string"

      - label: "Publish Date"
        name: "date"
        widget: "datetime"

      - label: "Type"
        name: "type"
        widget: "relation"
        collection: "data"
        file: "entry_categories"
        search_fields: ["entry_categories.*.name"]
        display_fields: ["entry_categories.*.display_name"]
        value_field: "entry_categories.*.name"

      - label: "Body"
        name: "body"
        widget: "markdown"